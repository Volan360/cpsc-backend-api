{
  "info": {
    "name": "CPSC Backend API",
    "description": "Collection for CPSC Backend API with AWS Cognito authentication",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Authentication",
      "item": [
        {
          "name": "Sign Up",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"Test@1234\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/signup",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "signup"
              ]
            },
            "description": "Register a new user in AWS Cognito. User will receive a verification code via email."
          },
          "response": []
        },
        {
          "name": "Confirm Sign Up",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\",\n  \"confirmationCode\": \"123456\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/confirm",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "confirm"
              ]
            },
            "description": "Confirm user signup with the verification code sent to their email. Must be done before login."
          },
          "response": []
        },
        {
          "name": "Resend Verification Code",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/resend-code",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "resend-code"
              ]
            },
            "description": "Resend the verification code to the user's email if they didn't receive it or it expired."
          },
          "response": []
        },
        {
          "name": "Login",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"Test@1234\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/login",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "login"
              ]
            },
            "description": "Authenticate user and receive JWT tokens. User must be confirmed before logging in."
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// Automatically save the idToken to environment variable",
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.environment.set(\"idToken\", jsonData.idToken);",
                  "    pm.environment.set(\"accessToken\", jsonData.accessToken);",
                  "    pm.environment.set(\"refreshToken\", jsonData.refreshToken);",
                  "    console.log(\"Tokens saved to environment variables\");",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Protected Endpoints",
      "item": [
        {
          "name": "Get Profile",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{idToken}}",
                "description": "JWT token from login"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/secure/profile",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "secure",
                "profile"
              ]
            },
            "description": "Get authenticated user's profile (requires valid JWT token)"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Institutions",
      "item": [
        {
          "name": "Create Institution",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{idToken}}",
                "description": "JWT token from login"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"institutionName\": \"Chase Bank\",\n  \"startingBalance\": 324.50\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/institutions",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "institutions"
              ]
            },
            "description": "Create a new financial institution with a starting balance for the authenticated user"
          },
          "response": []
        },
        {
          "name": "Get Institutions",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{idToken}}",
                "description": "JWT token from login"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/institutions?limit=50",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "institutions"
              ],
              "query": [
                {
                  "key": "limit",
                  "value": "50",
                  "description": "Maximum number of institutions to return (1-100, default 50)"
                },
                {
                  "key": "lastEvaluatedKey",
                  "value": "",
                  "description": "Pagination token from previous response (use nextToken value)",
                  "disabled": true
                }
              ]
            },
            "description": "Get financial institutions for the authenticated user with pagination support. Use the nextToken from response to get next page."
          },
          "response": []
        },
        {
          "name": "Edit Institution",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{idToken}}",
                "description": "JWT token from login"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"institutionName\": \"Updated Bank Name\",\n  \"startingBalance\": 1500.00\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/institutions/550e8400-e29b-41d4-a716-446655440000",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "institutions",
                "550e8400-e29b-41d4-a716-446655440000"
              ]
            },
            "description": "Edit an existing institution's name and/or starting balance. Both fields are optional. If startingBalance is changed, currentBalance is adjusted by the same difference. Replace the UUID in the path with the actual institutionId from Get Institutions response."
          },
          "response": []
        },
        {
          "name": "Delete Institution",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{idToken}}",
                "description": "JWT token from login"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/institutions/550e8400-e29b-41d4-a716-446655440000",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "institutions",
                "550e8400-e29b-41d4-a716-446655440000"
              ]
            },
            "description": "Delete a specific institution for the authenticated user. Replace the UUID in the path with the actual institutionId from Get Institutions response."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Transactions",
      "item": [
        {
          "name": "Create Transaction",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "description": "JWT token from login"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"DEPOSIT\",\n  \"amount\": 1000.50,\n  \"tags\": [\"salary\", \"monthly\"],\n  \"description\": \"January salary deposit\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/institutions/550e8400-e29b-41d4-a716-446655440000/transactions",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "institutions",
                "550e8400-e29b-41d4-a716-446655440000",
                "transactions"
              ]
            },
            "description": "Create a new transaction (deposit or withdrawal) for a specific institution. Replace the UUID in the path with the actual institutionId from Get Institutions response. Type can be DEPOSIT or WITHDRAWAL."
          },
          "response": []
        },
        {
          "name": "Get Institution Transactions",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "description": "JWT token from login"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/institutions/550e8400-e29b-41d4-a716-446655440000/transactions",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "institutions",
                "550e8400-e29b-41d4-a716-446655440000",
                "transactions"
              ]
            },
            "description": "Retrieve all transactions for a specific institution, sorted by creation date (newest first). Replace the UUID in the path with the actual institutionId from Get Institutions response."
          },
          "response": []
        },
        {
          "name": "Update Transaction",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "description": "JWT token from login"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"WITHDRAWAL\",\n  \"amount\": 200.00,\n  \"description\": \"Updated description for transaction\",\n  \"tags\": [\"updated\", \"expense\"],\n  \"transactionDate\": 1735041600\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/institutions/550e8400-e29b-41d4-a716-446655440000/transactions/550e8400-e29b-41d4-a716-446655440002",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "institutions",
                "550e8400-e29b-41d4-a716-446655440000",
                "transactions",
                "550e8400-e29b-41d4-a716-446655440002"
              ]
            },
            "description": "Update an existing transaction for the authenticated user. All fields in the request body are optional - only include the fields you want to update. Replace the institution UUID and transaction UUID in the path with actual IDs from Get Institution Transactions response."
          },
          "response": []
        },
        {
          "name": "Delete Transaction",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}",
                "description": "JWT token from login"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/institutions/550e8400-e29b-41d4-a716-446655440000/transactions/550e8400-e29b-41d4-a716-446655440002",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "institutions",
                "550e8400-e29b-41d4-a716-446655440000",
                "transactions",
                "550e8400-e29b-41d4-a716-446655440002"
              ]
            },
            "description": "Delete a specific transaction for the authenticated user. Replace the institution UUID and transaction UUID in the path with actual IDs from Get Institution Transactions response."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Public Endpoints",
      "item": [
        {
          "name": "Hello",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/hello",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "hello"
              ]
            },
            "description": "Test endpoint to verify API is running"
          },
          "response": []
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8080",
      "type": "string"
    }
  ]
}
